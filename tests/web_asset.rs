#![allow(unused_imports)]
#![allow(unused_variables)]
#![cfg(all(target_arch = "wasm32"))]
use std::{assert_eq, str::FromStr, vec};

use bdk::blockchain::EsploraBlockchain;
use bitcoin::{consensus, Transaction};
use bitmask_core::{
    debug, info,
    rgb::{prefetch::prefetch_resolve_txs, resolvers::ExplorerResolver},
    structs::{
        ContractResponse, ContractType, ContractsResponse, EncryptedWalletData, FundVaultDetails,
        ImportRequest, MnemonicSeedData, WalletData,
    },
    web::{
        bitcoin::{
            get_assets_vault, get_encrypted_wallet, get_wallet_data, hash_password,
            save_mnemonic_seed,
        },
        json_parse, resolve,
        rgb::{import_contract, list_contracts},
        set_panic_hook,
    },
};
use wasm_bindgen::prelude::*;
use wasm_bindgen_futures::JsFuture;
use wasm_bindgen_test::*;
use web_sys::console;

wasm_bindgen_test_configure!(run_in_browser);

const ENCRYPTION_PASSWORD: &str = "hunter2";
const SEED_PASSWORD: &str = "";

#[wasm_bindgen_test]
async fn contract_legacy_import() {
    set_panic_hook();
    let mnemonic = env!("TEST_WALLET_SEED", "TEST_WALLET_SEED variable not set");
    let hash = hash_password(ENCRYPTION_PASSWORD.to_owned());

    info!("Import wallet");
    let mnemonic_data_str = resolve(save_mnemonic_seed(
        mnemonic.to_owned(),
        hash.clone(),
        SEED_PASSWORD.to_owned(),
    ))
    .await;
    let mnemonic_data: MnemonicSeedData = json_parse(&mnemonic_data_str);

    info!("Get vault properties");
    let vault_str: JsValue = resolve(get_encrypted_wallet(
        hash,
        mnemonic_data.encrypted_descriptors,
    ))
    .await;
    let wallet_data: EncryptedWalletData = json_parse(&vault_str);

    info!("Import Contract");
    let sk = wallet_data.private.nostr_prv;
    let contract_import = ImportRequest {
        import: ContractType::RGB20,
        data: "rgb1qyqqqqqqqvpspjk3hww77un84rmgq3fvud35leupfkjl5jlf9jn3chklztn2repsqyqdqpm3r0m4knyslrnzu8knn7y0ftrtzma9lhe5mjl28vmlhj0qf86l4qqsp5g8kzlmdlsqjwhkkv3suh7s60tf4tc5huycmurh9rf9pwhrw7vxzpcqzqqp6qrszzqqc677ucjgz5clpa0qwkxd56rq20q9p38uftgjrxjutw89hlwpk6csxqcqqyqqzqxsquqsqqgq6yrszqqpqqqaqpcpqrll7qqqq8gq034aae3ys9f37r67qavvmf5xq57q2rz0cjk3yxd9ckuwt07urd43qqqaqpcpqrll7qwsquqsplllqq7qqqqm78ld78rfztr5327zqqw0ustgzzdpwd7g4lm3g6v5zgd9vlyxncqswsnfw33k76twq428snm4wsrqyptkv9k82ewvz7xc56ze297vl7ewauvs800dtmf336rheka8e9tfpjskrnf4kqx8xcmjd9c8g5r4vf4k2722tult3mj8kr97x8p5vy5fzkktq9v08ulslqe35dsxqzz8d3dyhgwlr5gkg0wnp0cttqug8haxz2y3scnh4nj26p6783n6czursqh25qgr2d6xgzjgv4uygetrgdshqucrzqz85etjducqxmmwv5csxarhdueq2argwfjk2vcyvehh2u35q3nxjan9x5phx6tcxczhxetkv4hrwpt9d9nksapcq3hxjmn98yphgetwgyrx2mr9wejkussxw3mk2mrkv4pssargd9e8get9dezqsen0w4e8get9dezswenfve6x2etwgc3mll3eggu2xl2mtcamlvsdpzdmrfctn8mz9fqmsyne9vcy2hl05qg8gf5hgcm0d9hqj5mfvafkxunfwp6q2q0c9tyjln907lqc5auzyu600ssqv68pevvcgc94ggg6hsff5x659scz03tfyvvucz4er88v7sk3eetscz56eaer7nr6etkayxa87k5evqqqgqm3j9z65tcacp35uhsy2a50l4zxk8xvc5avx4z3axyvanasaq4vvqqyqgqqgmn0dejud00wvfyp2v0s7hs8trx6dps98szscn7y45fpnfw9hrjmlhqmdvgpq3ek7mt989l5phd9580f8pmrrs5q8609y9cpwfxtkhmjcryufx2j3jc3y40r3lgtzax2s55d5qzaj7x70h269fmrhdn7gt9ztwf4ah69zdzz98spqdfhgeq2g9k8q6rp2dkkzmrvqvdqzctpq93xyqtrvvqkgeqpv4jszenxq9nkwqtgdqqkj6gpdf4qz6mtq9kxcqtdd5qkumspdahszursq9chzqtjwgqhxucpw36qzat4q9m8vqthwuqhs7qp09usz7n689l5phd9580f8pmrrs5q8609y9cpwfxtkhmjcryufx2j3jc3y40qqpgpjy5phvcfsf26q26xarmga8jshu36fumew5z6z025lls2sdk3q35nu4v0lg8scwxz9dsmung3pwynd9x4r3f5cur0xj90xye9rmysxdsqppsumypa7w60hdxc9rf4c5lewm3ls8wfuyvzpv42wenpunfg5f23qqqqqqqqqqqqqrll7qqqqqqqqqz2tult3mj8kr97x8p5vy5fzkktq9v08ulslqe35dsxqzz8d3dyhgqswsnfw33k76twp3fkxunfwp69qatzddjhjpgplq4vjt7v4lmurznhsgnnfa7zqpngu893nprqk4ppr27p9xsm2sk9yaq00lnguyyjraghfavamcyg5cm8xpnlef98e37y8gzjwtz0g4spqapxjarrda5kuzz0w468qmmfde6qvqsyw3uxje9e58njgjqlxgkt7uuv0fhclshc5g2g73sdjlwr5yjf4fpsq4t2ksz8vmm4wn74uh3tjdhn6tn6fnzvyh2h0km5s03dcjuja932rr9hsvlxw6z964dve59a8pg8l72m29x0xw7rhvztx7eua5tdwp60f5n7ua5lsuytqyp4xarypeqhxcmfd9g8y6tww3skymr9qd0s2umsv93k2gqyv4uxxmppqech2mm5v4ejyprgv9eksgcxv3hkcmrpwgjqwur9wf3k2mn5y5ykzmtsv4e8xctwvsnq5ctsdaehgun0wp5x2fcgvfexzcmtv46yc2qgvfexzcmtv469y2ggv9ehgetjd9ekk2sywpk82uetq43k7mtdvykq2mtfde6hxtgrv3hhgts9wdkxzumg9uz85etjducqxmmwv5csxarhdueq2argwfjk2vcyvehh2u35q3nxjan9x5phx6tcxczhxetkv4hrwpt9d9nksapcq3hxjmn98yzkxmmvdahr5ztnv4kkjsm0d3hkuwcyd3jhxueuq4jhzatpds7swemjv4shgetj8cy8zat9wd6xjmmw8upxzazqq9q5zq2zggq5xscpg3zqz329q9ryvq28guq5sjqpf9yszjj2q995kq2vfsq56ngpfe8qzn60q9g9qq232yq4y5sp2dfsz4z5q9242q2k2cq4w4cptpvqzk2eq9d95znnw9p8yctrddjhgnzmp93xzcmt2dkxzumgts98xu2zwfskx6m9w3f96ptrv9ex2az7qekx7erpwd597zrzv93kkarfvd4kqqtpvyqkycspvd3szeryq9jk2qtxvcqkwecpdp5qz6tfq94x5qttdvqkcmqpd4kszmnwq9hk7qtswqqhzugpwfeqzumnq968gqt4w5qhvaspwamsz7rcq9uhjqt60gykxsnjv93kket5f3asgurfwpjhcztrgfexzcmtv469ylg9w35kcer90ev2dg9jgckacjfazprmurtyqmw894graphe4ppuqz2m036jvpnpwqqqg3sumypa7w60hdxc9rf4c5lewm3ls8wfuyvzpv42wenpunfg5f23qqqpv8dvddgksdt7m0v8sajlqwp008vxfq6uq8r78gxsw3azx4qycwaqzq6nw3jqsstvwp5xznn4d5pnupr6v4ex7vqrdahx2vgrw3mk7vs9w358yet9xvzxvmm4wg6qgenfwejn2qmnd9urvptnv4mx2m3hq4jkjemgwsuqgmnfdejnjq2pgyq5ysspgdpsz3zyq9z52q2xgcq5w3cpfpyqzj2fq99y5q2tfvq5cnqpf4xsznjwq9857q2s2qq4z5gp2ffqz56nq929gq2425q4v4sp2atszkzcq9v4jq26tgqkzcgpvf3qzcmrq9jxgqt9v5qkvespvansz6rgq95kjqt2dgqkk6cpd3kqzmtdq9hxuqt0duqhquqpw9cszunjq9ehxqt5wsqh2agpwemqzamhq9u8sqte0yqh57nxlakakgyn60jgqvam6ura5fvgma4f85jm04qecpvjetdnr69zmgqswsnfw33k76twqf28spsyqamx2unnd9hku6tru9vhl93k4a408z2ref3u4h0z97ur8j7r7e9sty0xjxj73p3jqe5kuur4w3e7ty0c68w9e5u3s565yswu44jtv65tdqres40czh7t0jsla2rrnws8da6hgur4w3ehdleadk84ewgukwy4u7dkgwn5knnwpwq0pnacreyf50dakz888ucgd3hkx665d9kk2mmkhkj0cq0n8d8edrz3n4d7dny5kgswsl9j0stmu7tghct4hv3md937zktljcm276hn39pu5c72mh3zlwpne0plvjc9j8nfrf0gsceqzp6zd96xxmmfdcz4g7zkv4eq2q2c56sty33dm3yn6yz8hcxkgpkuwt2s86r0n2zrcqy4klr4ycrxzakxxak0afvs8rpgs4mhcf6sef87zwp7h8vsw7hmq696k9wrpvd3zqqqpphse0xrzvxclk73drmqaweywle5fkzkt89pl3tdsjer2petvlr52qgr2d6xgrjpd3cxsc2ww4k5cmmyv9eksqelq3ax2un0xqpk7mn9xyphgam0xgzhg6rjv4jnxprxda6hydqyve5hvef4qdekj7pkq4ek2an9dcms2etfva58gwqyde5kuefeq9q5zq2zggq5xscpg3zqz329q9ryvq28guq5sjqpf9yszjj2q995kq2vfsq56ngpfe8qzn60q9g9qq232yq4y5sp2dfsz4z5q9242q2k2cq4w4cptpvqzk2eq9d95pnvdajxzumgtuqkzcgpvf3qzcmrq9jxgqt9v5qkvespvansz6rgq95kjqt2dgqkk6cpd3kqzmtdq9hxuqt0duqhquqpw9cszunjq9ehxqt5wsqh2agpwemqzamhq9u8sqte0yqh57n0w676flqp7va5l95v2xw4hekvjjezp6rukf7p00nedzlpwkaj8vqswsnfw33k76twppxx7cmt235k6eg9q838lctxlhaty4csmznvdf68ezvp5axmqzthx3l02ey5tsvftyjnzugm7ad5ey8cuchpa5ul3r62c6cklf0a7dxuh63mxlaunczf7hagqy94y36zgdhkuarjv93hgyjyd9mxjumfvfkx2stnwdjhg5msv43svqsxdesk66twv7cww7zyz8mzn6den9f2net277sms9r7pwcsv76mj56rp3cup8k8zztswfjkx6tnd9hka325zw8w2ql9a6h2uq66xqulexwzqlf8t8g3ajpempygyhu9wn99wkmu9e6lfkluxu5zqx78933fs6sg7fe5evl9puewd2kj7gf58adqzq6nw3jqjstvwp5xzsmpwpesxxspg9qszsjzq9p5xq2ygsq523gpgerqz368q9yysq2ffyq55jspfd9sznzvq9x56q2wfcq57ncp2pgqz523q9f9yq2n2vq4g4qp242sz4jkq9t4wq2ctqq4jkgptfd8dleadk84ewgukwy4u7dkgwn5knnwpwq0pnacreyf50dakz888ucqpqdlrlklr353936g40pqq887g95ppxshxly2lac5dx2pyxjk0jrfuqqqqqqqqqqqqrllllllllllllu2rwnej33m8vawxyxkywtdvf7gcm6apfs8f0vs70xs7pp23yk24cqqsvp8c45jxxwvp2u3nnk0gtguu4cvp2dv7u3lf3av4mwjrwnlt2vkqqqqqqqqqqqqplllqqqqqqqqqzxlj3qzy3p4relwuqzqj3txvhr0d9c07yrxu52lyjfcmwxl6cemgqg8gf5hgcm0d9hqg4rcf9hqvpq2wpex2aj0w468qat52f6q7llx3cgfy863wn6emhsg3f3kwvr8ljj20nrugws9yuky73tqjumfvafkxunfwp6z80l789pr3gmatd0rh0ajp5yfhvd8pwvlvg4yrwqj0y4nq32la7sgwdjhzat9de3kt02ee8wgggtm23cg09qdmz5zn0t06lahzya47glkg7rgr856dtlhqamkjarwv4eh8020l2haa9v9rsecf2ruj0hf3jgsma7324j54wmdxxdpkdja60lhjy5phvcfsf26q26xarmga8jshu36fumew5z6z025lls2sdk3q35szz6jgapyxmmww3exzcm5qazx2arpd9k8xpgp6gnkqkm90ev3knlk24jr3vkvj226y0uszkg59ys5zqlg3h9f33hetr3fuuen7vsskg364qqm9j40g8sf84qxqvrr54atldkvxaxcw2gqpzaascz0nx6ujpraup74tyrf52rdyly5zscsdch4at3xdtjy7utgwqgqqqqqqqqqqqyqqqqqqqqqqq9ygg78dshkuv8hdmy4mr5yat6a6ntp4czv0htx70lhhvl0ascplcqqsvp8c45jxxwvp2u3nnk0gtguu4cvp2dv7u3lf3av4mwjrwnlt2vkqqqqqqqqqqqqpllllllllllll7nc3gmddc6uj3djyjrfze0js3r3z7z02kmtfp9j7g0n2wt3wzkcgqgr2d6xgqj4xsp3qqjlxqqqyhe3qyp97vszqf0nxqcztu6qgqjlx5zsyhekqcp97dc8qf0nszqztuusjq6lxycq5q6lxycskq6lxyeqcq6lxyes6q6lxy6quq6lxy6sltngjnydshslfdh85vw6hat0dgyurapr7m89l4y7544uqfwtfu3rqyp4xaryp3qkcurgv9882m2yv9eksqelq3jxzumg95z85etjducqxmmwv5csxarhdueq2argwfjk2vcyvehh2u35q3nxjan9x5phx6tcxczhxetkv4hrwpt9d9nksapcq3hxjmn98yq5zsgpgfpqzs6rq9zygq29g5q5v3spgarszjzgq9y5jq22fgq5kjcpf3xqzn2dq98yuq20fuq4q5qp29gsz5jjq9f4xq252sq424gp2etqz46hq9v9sq2etyq45kspv9sszcnzq93kxqtyvsqk2egpvenqzem8q95xsqtfdyqk56spdd4szmrvq9kk6qtwdcqk7mcpwpcqzut3q9e8yqtnwvqhgaqpw46szankq9mhwqtc0qqhj7gp0fatqcjrvx7tr0ekuvnare489kvg4s0t9f6zvgkx0k72xn2t8cpz54qqqucz03tfyvvucz4er88v7sk3eetscz56eaer7nr6etkayxa87k5evgqqkzlmdlsqjwhkkv3suh7s60tf4tc5huycmurh9rf9pwhrw7vxzpcqzz6jgapyxmmww3exzcm5z9fxjcmpwfjxjctwgdhkuarjv93hgpgp8e2cl7s0psuvy2mphex3zzufx62d28znf3cx7dy27vfj28kfqvmtpemcgsglv20fhxv49209dtm6rwq50c9mzpnmtw2ngvx8rsy7cugppdfywsjrdah8gunpvd6qkstnwdjhgnnpd45kuecxqvr8g6trddjh9d2ytrc9tr4mv0kthfy8acwhvnw7msefug8v8ax07fckhvd6ktvpq3hxzmt9cjhnsw6ngcc3p2gpck0lu4nsl883pwk03cnw5k5q9vtvmvl8t7aswer9w3skjmrnxuv3gk4z78wqvd89upzhdrlag343enx98tp4g50f3r8vlv8g9trt23zc7p2cawmraja6fplwr4mymhkux20zpmplfnljw94mrw4jmqgppdfywsjrdah8gunpvd6qv4rfvd4k2us9qx2cu208xvlnyy9jyw4gqxev4t6puzfagpsrqca902lmdnphfkrjnwdpuujys8ej9jlh8rr6d78u979zzj85vrvhmsapyjd2gvq92645qyr5y6t5vdhkjmsy23uxjeq9qxcxysmphjcm7dhrylg7dfednz9vr6e2wsnz93nahj356je7qg49fwdwlq98djwwu7jfctp75dw0ap5z0wkl6nkjkeunvf0t65wzgl9fqqy9ttxdp0fc2plljk63fnenhsamqjehk08dzmtswn6dylh8d8u8pzcpqqqqqqqqqqqzsqqqqqqqqqqqh8hkgysakyxlrqk5macn4wet96t6w0u0nsgklq04g4mu8c9lq9dszq6nw3jqx3r9vvps5pr6v4ex7vqrdahx2vgrw3mk7vs9w358yet9xvzxvmm4wg6qgenfwejn2qmnd9urvptnv4mx2m3hq4jkjemgwsuqgmnfdejnnwsr5f4fgv95c6ezpers727mekrz8gx8lwpertzptrjamm9hd0yqqy94y36zgdhkuarjv93hgr6swfhk7ej0vefx2um9wfmx2ucxqgz82arcd7c7gwlvst3cyxed0n8w3xnayy763dm7agz33086fakklr07q2tduptswfhk7e52rwnej33m8vawxyxkywtdvf7gcm6apfs8f0vs70xs7pp23yk246aascz0nx6ujpraup74tyrf52rdyly5zscsdch4at3xdtjy7utgwqgr2d6xgrzpd3cxsc2rv9c8xnn4d5pjgpr6v4ex7vqrdahx2vgrw3mk7vs9w358yet9xvzxvmm4wg6qgenfwejn2qmnd9urvptnv4mx2m3hq4jkjemgwsuqgmnfdejnjq2pgyq5ysspgdpsz3zyq9z52q2xgcq5w3cpfpyqzj2fq99y5q2tfvq5cnqpf4xsznjwq9857q2s2qq4z5gp2ffqz56nq929gq2425q4v4sp2atszkzcq9v4jq26t275l740m62c28pnsj58eylwnry3phmaz4t9f2ak6vv6rvm9m5llwqg8gf5hgcm0d9hqw4mfw3hx2umnq5qltjkt0valu23ry5atzgq2p0rumjzvwtwjhzm2vp8swpfjnwev2j9at8yaeppp0d28ppu5phv2s2dadltlkugnkher7ercdqv7nf407uqswsnfw33k76twq4fk2u2wduzsrcnlu9n0m74j2ugd3fkx5aru3xq6wndsp9mnglh4vj29cxy4jff3hh554hwvjyz4ntuaec5ghmfe47r8mhaqw94peu33dcqg0sazmckqzz6jgapyxmmww3exzcm5ppxkjmt9gd5xzusr95zx27rrdsssg6rpwd5zxpnydakxcctjyspkzmtsycz8qmr4wv4sgerpwd5z6qmyda6zupr6v4ex7vqrdahx2vgrw3mk7vs9w358yet9xvzxvmm4wg6qgenfwejn2qmnd9urvptnv4mx2m3hq4jkjemgwsuqgmnfdejnjptrv9ex2az7qekx7erpwd597qtpvyqkycspvd3szeryq9jk2qtxvcqkwecpdp5qz6tfq94x5qttdvqkcmqpd4kszmnwq9hk7qtswqqhzugpwfeqzumnq968gqt4w5qhvaspwamsz7rcq9uhjqt60tz27wpm2drrzy9fq8zelljkwruu7y96e78zd6j6sq43dndnua0mkqgt2fr5ysm0de68yctrwszyuctdv5zsrwdwlq98djwwu7jfctp75dw0ap5z0wkl6nkjkeunvf0t65wzgl9fc42p8rh9q0j7at4wqddrqw0un8pq05n4n5g7equasjyzt7zhfjjszz6jgapyxmmww3exzcm5p9g8yetrd9ekjmmwqvfsk6twv35hv6tnd93xcegqq3jx2cmfqyzkxetww35syptdd9kxc6grp9jx2cmff45kcmrfqs9xxetww35566tvd35s2ptdd93hymcxp9jx2cmff45kxun0qu9xxetww35566trwfhssprwv9hx7zggv3jkx62wv9hx7zsfvdjkuarffeskumctq3cxjcm0psyxgetrd9gxjcm0p5ykxetww354q6trdu8q2en9d46x7rcfv3jkx62xv4khgmcspf3k2mn5d9rx2mt5dugsgct5w3h3934aae3ys9f37r67qavvmf5xq57q2rz0cjk3yxd9ckuwt07urd43qqqqpj2my6r83ng00glfm8d2uqjczm60gtnx6353wp5gxe9uemrrzfvnqqytm622mhxfzp2e47wuu2yta5u6lpnam7s8z6su7gckuqy8cw3dutqpqqqqqqqqqqqyqqqqqqqqqqqqetgmh800wfn63a5qg5kwxc60u7q5mf06f05jefcutm039e4puscqzz6jgapyxmmww3exzcm5p92xjmt9wd6xzmtsq5q43f4qkfrzmhzf85gy00sdvsrdcuk4q05xlx5y8sqftd782fsxv97tjk80a8rdxp83xg3w9fyswyjwsmn758z6wn3yc03zxhmvf54f55qsx5m5vs95setcg3jkx5mdv9kxcqcsq3ax2un0xqpk7mn9xyphgam0xgzhg6rjv4jnxprxda6hydqyve5hvef4qdekj7pkq4ek2an9dcms2etfva58gwqyde5kuefeqd6x2mnpqejkcetkv4hxypn5wajkcan9vvy8g6rfwf6x2etwvsyxvmm4wf6x2etwv5rkv6txw3jk2mnxestcmzngt9ghenlm9mh3jqaaa40dxx8gwlxm5ly4dyx2zcwdxkcqzp6zd96xxmmfdcz9xct5wvzszmrrwm875kgr3s5g2amuyagv5nlp8qltnkg80tasdzatzhpskxc3ea6jwl9se2d9ht7wpc6u9apwtum3x9ljupwa02mu95dv6k2kjt5qqpgpla4fc74q54hcytz9uu6em78ypelsays8ra6pm3pkcuvqdkckvwaapejnfnqcuwkvjnj579f28cdsmln4uya70ngmjgjcq7j2jefru3qppdfywsjrdah8gunpvd6qjnt9v35kz4rewpjsvqcyw3uhqe0ld2w84g99d7pzc308xkwl3eqw0u8fypclwswugdk8rqrdk9nrhvrhxatzw3uhqe0kevx6dyjswjlxhkevtqtqt9w08kqxwxpw7fallymu2cy90ycvucrkx6rpwfek2a8kevx6dyjswjlxhkevtqtqt9w08kqxwxpw7fallymu2cy90ycvumfzwczmv4l9jx607e2kgw9jejfftg3ljq2ezs5jzsgrazxu4xxx7qqgv8xeq00nknamfkpg6dw987tku0upmj0prqst92nkvc0y629z25gqzqqqqqqqqqqqluqqqqqqqqqqpcnlu9n0m74j2ugd3fkx5aru3xq6wndsp9mnglh4vj29cxy4jff3qqqqfev3lrgachxnjxzn2sjpmjkkfdn23d5q0xz4lq2led72rl4gvwd6qqygm72yqgjyx508amsqgz29vejuda5hplcsvmj3tujf8rdcmltr8dqqqqqqqqqqqqq0llllllllllll7flpztnzzdps3hey7ekddgfnu3eaw2th6e05j3nlrlv2fkf2z0rszq6nw3jqgsn0dakqxqs9veskcum9qqz8gun4v5qlg8e2vvjdetd9zc4mxq600s4pnt2qhyfyldr8u3x95rth93psmrspqdfhgeq9g9k8q6rpqv6qzs2pq9pyyq2rgvq5g3qpg4zsz3jxq9r5wq2gfqq5jjgpff9qzj6tq9xycq2df5q5unspfa8sz5zsq9g4zq2j2gq4x5cp232qz424q9t9vq2h2uq4skqpt9vszkj6q9skzqtzvgqkxccpv3jqzet9q9nxvqt8vuqks6qpd95sz6n2q94kkqtvdsqk6mgpdehqzmm0q9c8qqt3wyqhyuspwdeszar5q96h2qtkwcqhwacp0puqz7teq9a84aw2edanhl32yvjn4vfqpg9u0nwgf3ed62utdfsy7pc9x2dm932gqqy2gs3uwmp0dcc0wmkftk8gf6h4m4xkrtsyclwkdull0we7lmpsrlsqqqqqqqqqqqq0llllllllllll7m9smf5j2p6tu67m93vpvpv4eu7cqecc9me8hlun03tqs4unpnnqqpqzqqzxummwvhrtmmnzfq2nru84up6cekngvpfuq5xyl39dzgv6t3dcuklacxmtzqgywdhk6ew0w5nhevx2nfd6lnswxhp0gtjlxuf30uhqtht6klpdrtx4j45jaruz4jf0ejhl0sv2w7pzwd8hcgqxdrsukxvyvz65yydtcy56rd2zcqg8gf5hgcm0d9hqk5mrwf5hqazz096x2uc9qxjyy0rkctmwxrmkaj2a36zw4awaf4s6upx8m4n08lmmk0h7cvqlal27tc4exmea9eaye3xzt4thmd6g8ckufwfwjc4p3jmcx0n8dpzaqyr5y6t5vdhkjmsy2ehh2aq9q838lctxlhaty4csmznvdf68ezvp5axmqzthx3l02ey5tsvftyjnrlm2n3a2pft0sgkytee4nhuwgrnlp6fqw8m5rhzrd3ccqmd3vcamqy94y36zgdhkuarjv93hgrzdv4jxjc2jv4n5uctdv5zsrj2my6r83ng00glfm8d2uqjczm60gtnx6353wp5gxe9uemrrzfvnqqq4v58m9xavr3mpd7tkwfa3aqfrfzr6m9h8q4h450xfne9gx79nzjqvqqp4y36zqvqdp5q8qqqqqqgqqngqw4jslv5m4sw8v9hewee8k85pydyg0tvkuuzk7k3uex0y4qmckv2gqqqq9hejcxuccpgjal6e6r3tuqrk7vm02y3dpnr0lwvwd8wd59te7g9sqqz4y36zxgcqvrrzw4exuety2d6hqurv0yqcyl3el2kqh8ps5druntxqsp590khsqfsq5pmjsk7u0y5hfdz5vxsqqyrkxun9v96x2eqpetgmh800wfn63a5qg5kwxc60u7q5mf06f05jefcutm039e4puscqzqqvd9ehxat9v3fh2ursd3usrqn788a2czuuxz350jdvczqxs4767qpxqzs8w2zmm3ujja9523s6qqqsuun9wpkxzcm9v3fh2ursd3usrqn788a2czuuxz350jdvczqxs4767qpxqzs8w2zmm3ujja9523s6qqqsgumsv43szugm7ad5ey8cuchpa5ul3r62c6cklf0a7dxuh63mxlaunczf7hagqyqq2ar9wfkhxqdsh7m0uqyn4a4nyv89l5xn66d2799lpxxlqaeg6fgt4cmhnpsswqqsqpg2v9ehxet5famkuetjqgqqqqgfvf6hymj9wphkx6qpqyqqqztzw4exu5nfva58gqgpqqq3y6twvekxzarfdahyzmrvdamkzmnrv5pqzqqppd6hqerpw3j4y6t8dp6qzqgqqqqqzpccxc6jrsxzuvv3tjpsf2fnaruu8e5az8len242zjvuv85cx9dhqsrkxun9v96x2eqqqyqqzqqvd9ehxat9v3fh2ursd3usqqgqqyqqgumsv43sqqgqqyqq2ar9wfkhxqqpqqqsqpq2v9ehxet5famkuetjqqqqplllp9382unwg4cx7cmgqqqqqqgqzf5kuenvv96xjmmwg9kxcmmhv9hxxegqqqq0llctw4cxgct5v4fxjemgwsqqqqqpqqqqxqgrqsrqgsn4wfhqzq05hh9502nak892k4jk7jpwv7y0yt852d8e84gxeke4pcfmn5xeavqsccn4wfhx2eznw4c8qmreqqqsqqgqqyz82um9vsqsjcn4wfh9y6t8dp6qzqqpqqqsven4w36hyegpp9382unw2f5kw6r5qqqqzqqqqvqsxpgqq4yhxum4v5qszpccxc6jrsxzuvv3tjpsf2fnaruu8e5az8len242zjvuv85cx9dhqyxxjumnw4jkg5m4wpcxc7gqqyqqzqqpq36hxetyqyfxjmnxd3shg6t0deqkcmr0waskucm9qyq0llczpd3x2mn9ve5kx6tpwfuszznpwdek2az0wahx2usqqrll7pnxw4682un9qyfxjmnxd3shg6t0deqkcmr0waskucm9qqq0llcqqsqsxpqxqy9kyetwv4nxjcmfv9e8jz20wpjku3tsda3ksqgqqqqsgatnv4jqzztzw4exu3tsda3ksqgqqyqqyztzw4exu5nfva58gqqpqqqsqprwv4u8gqgfvf6hymj9wphkx6qqqqqsqqqqqyykyatjdefxjemgwsr9yetwv9kk2qgqqypkuethqyz8xur9vvqsqqgqqyz82um9vsqskatsv3shge2jd9nksaqpqqqsqqgxve6hgatjv5qskatsv3shge2jd9nksaqqqqqsqqqqqyrxvat5w4ex2p6jv4cxcctrv5qsra9aedr65ld3e244v4h5stn83rezeaznf7fa2pkdkdgwzwuapk0tqy88yetsd3skxety2d6hqurv0yqqzqqpqqqsgatnv4jqzztzw4exu5nfva58gqgqqyqqyzmzv4hx2enfvd5kzuneqy9xzumnv46y7amwv4eqqq8llurxvat5w4ex2qgfvf6hymjjd9nksaqqqqqsqqqyqypqxpgppd3x2mn9ve5kx6tpwfuss4rjv9h8xen9wgqqqqqpppc8yetkd9hh2ucppfshxum9w38hwmn9wgqsplllqy9kyetwv4nxjcmfv9e8jqg2v9ehxet5famkuetjqyq0llcqqypqzznpwdek2az0wahx2usqx8jw9vr0ltpyc4z45emu8pcgrhskjl4mjxa8rmecsf0ujvqmeqpszzz5wfskuumxv4eqpgzrladl35n674gvg3j2r2yndcljgrhgpay8ndtkeq64kt9c28fmmuevrwvvq5fwlavapc47qpm0xdh4zgkse3hlhx8xnhx6z4ulyzcqxqcqqa3hyetpw3jkf5q8q3ehqetr6yrs2ar9wfkhxqwsqu9xzumnv46y7amwv4eqqqwsquy9gunpdeekvetjqruy2tqgw4esvqp0q4cyaqsqtxtrs7l08f8u005kqytwjc5l0yskwqq92fr5yv3sqcxxyatjdejkg5m4wpcxc7gpsflrn74vpwwrpg68exkvpqrg2ld0qqnqpgrh9pdac7ffwj69gcdqqqg8vdex2ct5v4jqrjk3hww77un84rmgq3fvud35leupfkjl5jlf9jn3chklztn2repsqyqqc6tnwd6k2eznw4c8qmreqxp8uw064s9ecv9rgly6esyqdpta4uqzvq9qwu59hhre996tg4rp5qqppeex2urvv93k2eznw4c8qmreqxp8uw064s9ecv9rgly6esyqdpta4uqzvq9qwu59hhre996tg4rp5qqpq3ehqetrq9c3ha6mfjg03e3wrmfelz854343d7jlmu6de04rkdlme8syna06sqgqq46x2undwvqmp0aklcqf8tmtxgcwtlgd84564u2t7zvd7pmj35jsht3h0xrpquqpqqzs5ctnwdjhgnmhdejhyqsqqqqsjcn4wfhy2ur0vd5qzqgqqqykyatjdefxjemgwsqszqqpzf5kuenvv96xjmmwg9kxcmmhv9hxxegzqyqqzzm4wpjxzar92f5kw6r5qyqsqqqqqyr3sd34y8qv9ccezhyrqj5n868ec0nf6y0lnx4259yecc0fsv2mwpq8vdex2ct5v4jqqqgqqyqqc6tnwd6k2eznw4c8qmreqqqsqqgqq3ehqetrqqqsqqgqq46x2undwvqqzqqpqqzq5ctnwdjhgnmhdejhyqqqqrll7ztzw4exu3tsda3ksqqqqqqsqynfdenxcct5d9hkustvd3hhwctwvdjsqqqqlllskatsv3shge2jd9nksaqqqqqqzqqqqvqsxpqxq3p82unwqyqlf0wtg748mvw24dt9dayzueug7gk0g560j02sdndn2rsnh8gdn6cpp3382unwv4j9xatswpk8jqqpqqqsqqgyw4ek2eqpp9382unw2f5kw6r5qyqqzqqpqen82ar4wfjszztzw4exu5nfva58gqqqqyqqqqcpqvzsqp2fwdeh2egpqyr3sd34y8qv9ccezhyrqj5n868ec0nf6y0lnx4259yecc0fsv2mwqgvd9ehxat9v3fh2ursd3usqqgqqyqqzpr4wdjkgqgjd9hxvmrpw35k7mjpd3kx7ampde3k2qgqlllsyzmzv4hx2enfvd5kzuneqy9xzumnv46y7amwv4eqqq8llurxvat5w4ex2qgjd9hxvmrpw35k7mjpd3kx7ampde3k2qqqlllsqpqpqvzqvqgtvfjkuetxd93kjctj0yy57ur9dezhqmmrdqqsqqqpq36hxetyqyykyatjdezhqmmrdqqsqqgqqgykyatjdefxjemgwsqqzqqpqqzxuetcwsqsjcn4wfhy2ur0vd5qqqqpqqqqqqgfvf6hymjjd9nksaqx2fjkuctdv5qsqqgrdejhwqgywdcx2ccpqqqsqqgyw4ek2eqppd6hqerpw3j4y6t8dp6qzqqpqqqsven4w36hyegppd6hqerpw3j4y6t8dp6qqqqpqqqqqqgxve6hgatjv5r4yetsd3skxegpq86tmj684f7mrj4t2et0fqhx0z8j9n69xnun65rvmv6suyae6rv7kqgwwfjhqmrpvdjkg5m4wpcxc7gqqyqqzqqpq36hxetyqyykyatjdefxjemgwsqsqqgqqg9kyetwv4nxjcmfv9e8jqg2v9ehxet5famkuetjqqq0llcxve6hgatjv5qsjcn4wfh9y6t8dp6qqqqpqqqqgqgzqvzszzmzv4hx2enfvd5kzunepp28yctwwdnx2usqqqqqzzrswfjhv6t0w4eszznpwdek2az0wahx2uspqrll7qgtvfjkuetxd93kjctj0yqs5ctnwdjhgnmhdejhyqgqlllsqqgzqy9kyetwv4nxjcmfv9e8jqp3un3tqml6cfx9g4dxwlpcwzqau95hawu3hfc77wyztlynqx7gqvqss4rjv9h8xen9wgq2qsllt0udy7h42rzyvjs63ymw8ujqa6q0fpum2akgx4djewz36wlcg5kqsatnqcqz7ptsf6pqqkvk8pa77wj0c7lfvqgka93f77fpvupsxqq8vdex2ct5v4jdqpcywdcx2c73quzhgetjd4esr5q8pfshxum9w38hwmn9wgqqr5q8pp28yctwwdnx2usqqqqqpgzrladl35n674gvg3j2r2yndcljgrhgpay8ndtkeq64kt9c28fmsqqqqqcrqqqsqpqqqqqqqqxsquqsqpsqq9zqz3qqqtgswqgqqgqqqqqp6qrszqgqqvqh8jfeug2m48tvr5xxrrdc7zpk3fh2e0wqe0tscy9dee0lu37ruzgqqqqqpwk77zdny9gkkyyq2qqqqqqqqqqqenjuzlma9vu67muehswp6ld7z90kz760jca9znf89twkhjyusynqqqqqqqqqqqqqqqqqqqqqqqenq9ys".to_string(),
    };

    let req = serde_wasm_bindgen::to_value(&contract_import).expect("oh no!");
    let resp = resolve(import_contract(sk.clone(), req)).await;
    let resp: ContractResponse = json_parse(&resp);

    // TODO: This not working =(
    // let resp: JsValue = resolve(list_contracts(sk)).await;
    // let resp: ContractsResponse = json_parse(&resp);

    // assert_eq!(1, resp.contracts.len());
}

#[wasm_bindgen_test]
async fn contract_strict_import() {
    set_panic_hook();
    let mnemonic = env!("TEST_WALLET_SEED", "TEST_WALLET_SEED variable not set");
    let hash = hash_password(ENCRYPTION_PASSWORD.to_owned());

    info!("Import wallet");
    let mnemonic_data_str = resolve(save_mnemonic_seed(
        mnemonic.to_owned(),
        hash.clone(),
        SEED_PASSWORD.to_owned(),
    ))
    .await;
    let mnemonic_data: MnemonicSeedData = json_parse(&mnemonic_data_str);

    info!("Get vault properties");
    let vault_str: JsValue = resolve(get_encrypted_wallet(
        hash,
        mnemonic_data.encrypted_descriptors,
    ))
    .await;
    let wallet_data: EncryptedWalletData = json_parse(&vault_str);

    info!("Import Contract");
    let sk = wallet_data.private.nostr_prv;
    let contract_import = ImportRequest {
        import: ContractType::RGB20,
        data: "0100000000030300cad1bb9def7267a8f680452ce3634fe7814da5fa4be92ca71c5edf12e6a1e4300100d007711bf75b4c90f8e62e1ed39f88f4ac6b16fa5fdf34dcbea3b37fbc9e049f5fa80100d107b0bfb6fe0093af6b3230e5fd0d3d69aaf14bf098df07728d250bae3779861070010001d007010800c6bdee62481531f0f5e0758cda686053c050c4fc4ad1219a5c5b8e5bfdc1b6b103030001000100d00701000100d1070100010001d0070100ffff000001d007c6bdee62481531f0f5e0758cda686053c050c4fc4ad1219a5c5b8e5bfdc1b6b10001d0070100ffff01d0070100ffff003c00001bf1fedf1c6912c748abc2001cfe4168109a1737c8aff7146994121a567c869e0107426974636f696e0554784f757406020576616c7565cc178d8a6859517ccffb2eef1903bded5ed318e877cdba7c95690ca161cd35b00c7363726970745075626b65794a5f3eb8ee47b0cbe31c346128915acb0158f3f3f0f8331a3606008476c5a4ba1df1d11643dd30bf0b583883dfa61289186277ace4ad075e3c67ac0b83802eaa01035374640a486578446563436170730310047a65726f30036f6e65310374776f320574687265653304666f757234046669766535037369783605736576656e3705656967687438046e696e65390374656e4106656c6576656e42067477656c76654308746869727465656e4408666f75727465656e45076669667465656e4623bffe394238a37d5b5e3bbfb20d089bb1a70b99f622a41b812792b30455fefa0107426974636f696e095369675363726970740501f82ac92fccaff7c18a77822734f7c200668e1cb198460b54211abc129a1b542c3027c5692319cc0ab919cecf42d1ce570c0a9acf723f4c7acaedd21ba7f5a9960000403719145aa2f1dc0634e5e045768ffd446b1cccc53ac35451e988cecfb0e82ac600040200046e6f6e65c6bdee62481531f0f5e0758cda686053c050c4fc4ad1219a5c5b8e5bfdc1b6b10104736f6d65397f40dda5a1de9387631c2803e9e521701724cbb5f72c0c9c499528cb11255e38fd0b174ca8528da005d978de7dd5a2a763bb67e42ca25b935edf451344229e01035374640a416c706861536d616c6c031a016161016262016363016464016565016666016767016868016969016a6a016b6b016c6c016d6d016e6e016f6f017070017171017272017373017474017575017676017777017878017979017a7a397f40dda5a1de9387631c2803e9e521701724cbb5f72c0c9c499528cb11255e00050191281bb3098255a02b46e8f68e9e50bf23a4f3797505a13d54ffe0a836d104693e558ffa0f0c38c22b61be4d110b893694d51c534c706f348af313251ec90336000861cd903df3b4fbb4d828d35c53f976e3f81dc9e11820b2aa76661e4d28a255100000000000000000ffff0000000000004a5f3eb8ee47b0cbe31c346128915acb0158f3f3f0f8331a3606008476c5a4ba0107426974636f696e0c5363726970745075626b65790501f82ac92fccaff7c18a77822734f7c200668e1cb198460b54211abc129a1b542c52740f7fe68e10921f5174f59dde088a63673067fca4a7cc7c43a05272c4f4560107426974636f696e084f7574706f696e7406020474786964b9a1e724481f322cbf738c7a6f8fc2f8a2148f460d97dc3a1249aa4300556ab404766f7574fd5e5e2b936f3d2e7a4cc4c25d577db7483e2dc4b92e962a18cb7833e676845d55accd0bd38507ff95b514cf33bc3bb04b37b3ced16d7074f4d27ee769f8708b01035374640e41736369695072696e7461626c65035f05737061636520046578636c210671756f7465732204686173682306646f6c6c6172240770657263656e742509616d70657273616e64260a61706f7374726f7068652708627261636b65744c2808627261636b6574522908617374657269736b2a04706c75732b05636f6d6d612c056d696e75732d03646f742e05736c6173682f047a65726f30036f6e65310374776f320574687265653304666f757234046669766535037369783605736576656e3705656967687438046e696e653905636f6c6f6e3a0973656d69436f6c6f6e3b046c6573733c05657175616c3d07677265617465723e087175657374696f6e3f02617440014141014242014343014444014545014646014747014848014949014a4a014b4b014c4c014d4d014e4e014f4f015050015151015252015353015454015555015656015757015858015959015a5a0a7371427261636b65744c5b096261636b536c6173685c0a7371427261636b6574525d0563617265745e066c6f646173685f086261636b7469636b60016161016262016363016464016565016666016767016868016969016a6a016b6b016c6c016d6d016e6e016f6f017070017171017272017373017474017575017676017777017878017979017a7a0963427261636b65744c7b04706970657c0963427261636b6574527d0574696c64657e58a6a0b2462ddc493d1047be0d6406dc72d503e86f9a843c0095b7c75260661700004461cd903df3b4fbb4d828d35c53f976e3f81dc9e11820b2aa76661e4d28a25510000161dac6b5168357edbd878765f0382f79d864835c01c7e3a0d0747a235404c3ba010353746408416c7068614e756d033e047a65726f30036f6e65310374776f320574687265653304666f757234046669766535037369783605736576656e3705656967687438046e696e6539014141014242014343014444014545014646014747014848014949014a4a014b4b014c4c014d4d014e4e014f4f015050015151015252015353015454015555015656015757015858015959015a5a016161016262016363016464016565016666016767016868016969016a6a016b6b016c6c016d6d016e6e016f6f017070017171017272017373017474017575017676017777017878017979017a7a66ff6ddb2093d3e48033bbd707da2588df6a93d25b7d419c0592cadb31e8a2da0107426974636f696e02547806040776657273696f6e6963e1597f9636af6af38943ca63cadde22fb833cbc3f64b0591e691a5e8863206696e70757473e591f8d1dc5cd39185354241dcad64b66a8b68079855f815fcb7ca1fea8639ba076f75747075747376ff3d6d8f5cb91cb3895e79b643a74b4e6e0b80f0cfb81e489a3dbdb08e73f3086c6f636b54696d656f76bda4fc01f33b4f968c519d5be6cc94b220e87cb27c17be7968be175bb23b6963e1597f9636af6af38943ca63cadde22fb833cbc3f64b0591e691a5e886320107426974636f696e055478566572050158a6a0b2462ddc493d1047be0d6406dc72d503e86f9a843c0095b7c7526066176c6376cfea59038c2885777c2750ca4fe1383eb9d9077afb068bab15c30b1b110000086f0cbcc3130d8fdbd168f60ebb2477f344d85659ca1fc56d84b235072b67c74501035374640e416c7068614e756d4c6f64617368033f047a65726f30036f6e65310374776f320574687265653304666f757234046669766535037369783605736576656e3705656967687438046e696e6539014141014242014343014444014545014646014747014848014949014a4a014b4b014c4c014d4d014e4e014f4f015050015151015252015353015454015555015656015757015858015959015a5a066c6f646173685f016161016262016363016464016565016666016767016868016969016a6a016b6b016c6c016d6d016e6e016f6f017070017171017272017373017474017575017676017777017878017979017a7a6f76bda4fc01f33b4f968c519d5be6cc94b220e87cb27c17be7968be175bb23b0107426974636f696e084c6f636b54696d650501e27fe166fdfab25710d8a6c6a747c8981a74db00977347ef564945c189592531711bf75b4c90f8e62e1ed39f88f4ac6b16fa5fdf34dcbea3b37fbc9e049f5fa8010b524742436f6e747261637412446976697369626c654173736574537065630602066e616d696e67b0e7784411f629e9b99952a9e56af7a1b8147e0bb1067b5b953430c71c09ec7109707265636973696f6ec554138ee503e5eeaeae035a3039fc99c207d2759d11ec839d848825f8574ca575b7c2e75f4dbfc3728201bc72c62986a08f2734cb3e50f32e6aad2f21343f5a010353746409416c70686143617073031a014141014242014343014444014545014646014747014848014949014a4a014b4b014c4c014d4d014e4e014f4f015050015151015252015353015454015555015656015757015858015959015a5a76ff3d6d8f5cb91cb3895e79b643a74b4e6e0b80f0cfb81e489a3dbdb08e73f300081bf1fedf1c6912c748abc2001cfe4168109a1737c8aff7146994121a567c869e0000000000000000ffffffffffffffff8a1ba799463b3b3ae310d62396d627c8c6f5d0a6074bd90f3cd0f042a892caae00083027c5692319cc0ab919cecf42d1ce570c0a9acf723f4c7acaedd21ba7f5a9960000000000000000ffff0000000000008df94402244351e7eee00409456665c6f6970ff1066e515f24938db8dfd633b40107426974636f696e045478496e06040a707265764f757470757452740f7fe68e10921f5174f59dde088a63673067fca4a7cc7c43a05272c4f4560973696753637269707423bffe394238a37d5b5e3bbfb20d089bb1a70b99f622a41b812792b30455fefa0873657175656e6365bd59c9dc84217b547087940dd8a829bd6fd7fb7113b5f23f64786819e9a6aff7077769746e657373bd4ffaafde95851c3384a87c93ee98c910df7d155654abb6d319a1b365dd3ff791281bb3098255a02b46e8f68e9e50bf23a4f3797505a13d54ffe0a836d10469010b524742436f6e74726163740744657461696c730501d227605b657e591b4ff6556438b2cc9295a23f901591429214103e88dca98c6f958e29e7333f3210b223aa801b2caaf41e093d40603063a57abfb6cc374d87290008bbd8604f99b5c9047de07d559069a286d27c94143106e2f5eae266ae44f7168701000000000000000800000000000000a4423c76c2f6e30f76ec95d8e84eaf5dd4d61ae04c7dd66f3ff7bb3efec301fe00083027c5692319cc0ab919cecf42d1ce570c0a9acf723f4c7acaedd21ba7f5a9960000000000000000ffffffffffffffffa788a36d6e35c945b224869165f2844711784f55b6b484b2f21f35397170ad8401035374640255340310025f3000025f3101025f3202025f3303025f3404025f3505025f3606025f3707025f3808025f3909035f31300a035f31310b035f31320c035f31330d035f31340e035f31350fae6894c8d85e1f4b6e7a31dabf56f6a09c1f423f6ce5fd49ea56bc025cb4f22301035374640c416c7068614e756d44617368033f04646173682d047a65726f30036f6e65310374776f320574687265653304666f757234046669766535037369783605736576656e3705656967687438046e696e6539014141014242014343014444014545014646014747014848014949014a4a014b4b014c4c014d4d014e4e014f4f015050015151015252015353015454015555015656015757015858015959015a5a016161016262016363016464016565016666016767016868016969016a6a016b6b016c6c016d6d016e6e016f6f017070017171017272017373017474017575017676017777017878017979017a7ab0624361bcb1bf36e327d1e6a72d988ac1eb2a742622c67dbca34d4b3e022a5400073027c5692319cc0ab919cecf42d1ce570c0a9acf723f4c7acaedd21ba7f5a9962000b0bfb6fe0093af6b3230e5fd0d3d69aaf14bf098df07728d250bae3779861070010b524742436f6e74726163741152696361726469616e436f6e747261637405013e558ffa0f0c38c22b61be4d110b893694d51c534c706f348af313251ec90336b0e7784411f629e9b99952a9e56af7a1b8147e0bb1067b5b953430c71c09ec71010b524742436f6e74726163740b41737365744e616d696e670603067469636b6572b54458f0558ebb63ecbba487ee1d764ddedc329e20ec3f4cff2716bb1bab2d81046e616d65c4af383b53463110a901c59ffe5670f9cf10bacf8e26ea5a802b16cdb3e75fbb0764657461696c733719145aa2f1dc0634e5e045768ffd446b1cccc53ac35451e988cecfb0e82ac6b54458f0558ebb63ecbba487ee1d764ddedc329e20ec3f4cff2716bb1bab2d81010b524742436f6e7472616374065469636b65720501958e29e7333f3210b223aa801b2caaf41e093d40603063a57abfb6cc374d8729b9a1e724481f322cbf738c7a6f8fc2f8a2148f460d97dc3a1249aa4300556ab40107426974636f696e04547869640501b0624361bcb1bf36e327d1e6a72d988ac1eb2a742622c67dbca34d4b3e022a54b9aef80a76c9cee7a49c2c3ea35cfe86827badfd4ed2b6793625ebd51c247ca9000855accd0bd38507ff95b514cf33bc3bb04b37b3ced16d7074f4d27ee769f8708b01000000000000002800000000000000b9ef64121db10df182d4df713abb2b2e97a73f8f9c116f81f54577c3e0bf015b010353746403446563030a047a65726f30036f6e65310374776f320574687265653304666f757234046669766535037369783605736576656e3705656967687438046e696e6539ba03a26a9430b4c6b220e470f2bdbcd8623a0c7fb8391ac4158e5ddecb76bc80010b524742436f6e74726163740f50726f6f664f6652657365727665730602047574786fb1e43bec82e3821b2d7ccee89a7d213da8b77eea0518bcfa4f6d6f8dfe0296de0570726f6f668a1ba799463b3b3ae310d62396d627c8c6f5d0a6074bd90f3cd0f042a892caaebbd8604f99b5c9047de07d559069a286d27c94143106e2f5eae266ae44f7168701035374640c416c706861436170734e756d0324047a65726f30036f6e65310374776f320574687265653304666f757234046669766535037369783605736576656e3705656967687438046e696e6539014141014242014343014444014545014646014747014848014949014a4a014b4b014c4c014d4d014e4e014f4f015050015151015252015353015454015555015656015757015858015959015a5abd4ffaafde95851c3384a87c93ee98c910df7d155654abb6d319a1b365dd3ff70107426974636f696e075769746e6573730501f5cacb7b3bfe2a23253ab1200a0bc7cdc84c72dd2b8b6a604f0705329bb2c548bd59c9dc84217b547087940dd8a829bd6fd7fb7113b5f23f64786819e9a6aff70107426974636f696e055365714e6f0501e27fe166fdfab25710d8a6c6a747c8981a74db00977347ef564945c189592531bde94addcc910559af9dce288bed39af867ddfa0716a1cf2316e0087c3a2de2c010b524742436f6e7472616374084d696d6543686172032d046578636c2104686173682306646f6c6c61722403616d702604706c75732b04646173682d03646f742e047a65726f30036f6e65310374776f320574687265653304666f757234046669766535037369783605736576656e3705656967687438046e696e65390563617265745e066c6f646173685f016161016262016363016464016565016666016767016868016969016a6a016b6b016c6c016d6d016e6e016f6f017070017171017272017373017474017575017676017777017878017979017a7ac4af383b53463110a901c59ffe5670f9cf10bacf8e26ea5a802b16cdb3e75fbb010b524742436f6e7472616374044e616d650501b9aef80a76c9cee7a49c2c3ea35cfe86827badfd4ed2b6793625ebd51c247ca9c554138ee503e5eeaeae035a3039fc99c207d2759d11ec839d848825f8574ca5010b524742436f6e747261637409507265636973696f6e03130b696e646976697369626c65000464656369010563656e746902056d696c6c690309646563694d696c6c69040a63656e74694d696c6c6905056d6963726f0609646563694d6963726f070a63656e74694d6963726f08046e616e6f0908646563694e616e6f0a0963656e74694e616e6f0b047069636f0c08646563695069636f0d0963656e74695069636f0e0566656d746f0f096465636946656d746f100a63656e746946656d746f11046174746f12c6bdee62481531f0f5e0758cda686053c050c4fc4ad1219a5c5b8e5bfdc1b6b1000000c95b268678cd0f7a3e9d9daae025816f4f42e66d469170688364bccec63125930008bde94addcc910559af9dce288bed39af867ddfa0716a1cf2316e0087c3a2de2c01000000000000004000000000000000cad1bb9def7267a8f680452ce3634fe7814da5fa4be92ca71c5edf12e6a1e430010b524742436f6e74726163740954696d657374616d70050158a6a0b2462ddc493d1047be0d6406dc72d503e86f9a843c0095b7c752606617cb958efe9c6d304f13222e2a4907124e86e7ea1c5a74e24c3e2235f6c4d2a9a501035374640b486578446563536d616c6c0310047a65726f30036f6e65310374776f320574687265653304666f757234046669766535037369783605736576656e3705656967687438046e696e65390374656e6106656c6576656e62067477656c76656308746869727465656e6408666f75727465656e65076669667465656e66cc178d8a6859517ccffb2eef1903bded5ed318e877cdba7c95690ca161cd35b00107426974636f696e045361747305016c6376cfea59038c2885777c2750ca4fe1383eb9d9077afb068bab15c30b1b11cf75277cb0ca9a5bafce0e35c2f42e5f371317f2e05dd7ab7c2d1acd595692e8000501ff6a9c7aa0a56f822c45e7359df8e40e7f0e92071f741dc436c71806db1663bbd0e6534cc18e3acc94e54f152a3e1b0dfe75e13be7cd1b9225807a4a96523e44010b524742436f6e7472616374094d656469615479706506030474797065ff6a9c7aa0a56f822c45e7359df8e40e7f0e92071f741dc436c71806db1663bb0773756274797065f6cb0da6925074be6bdb2c58160595cf3d8067182ef27bff937c560857930ce60763686172736574f6cb0da6925074be6bdb2c58160595cf3d8067182ef27bff937c560857930ce6d227605b657e591b4ff6556438b2cc9295a23f901591429214103e88dca98c6f000861cd903df3b4fbb4d828d35c53f976e3f81dc9e11820b2aa76661e4d28a255100100000000000000ff00000000000000e27fe166fdfab25710d8a6c6a747c8981a74db00977347ef564945c189592531000004e591f8d1dc5cd39185354241dcad64b66a8b68079855f815fcb7ca1fea8639ba00088df94402244351e7eee00409456665c6f6970ff1066e515f24938db8dfd633b40000000000000000fffffffffffffffff27e112e62134308df24f66cd6a133e473d72977d65f49467f1fd8a4d92a13c7010353746404426f6f6c03020566616c736500047472756501f41f2a6324dcada5162bb3034f7c2a19ad40b9124fb467e44c5a0d772c430d8e010353746405416c7068610334014141014242014343014444014545014646014747014848014949014a4a014b4b014c4c014d4d014e4e014f4f015050015151015252015353015454015555015656015757015858015959015a5a016161016262016363016464016565016666016767016868016969016a6a016b6b016c6c016d6d016e6e016f6f017070017171017272017373017474017575017676017777017878017979017a7af5cacb7b3bfe2a23253ab1200a0bc7cdc84c72dd2b8b6a604f0705329bb2c5480008a4423c76c2f6e30f76ec95d8e84eaf5dd4d61ae04c7dd66f3ff7bb3efec301fe0000000000000000fffffffffffffffff6cb0da6925074be6bdb2c58160595cf3d8067182ef27bff937c560857930ce600040200046e6f6e65c6bdee62481531f0f5e0758cda686053c050c4fc4ad1219a5c5b8e5bfdc1b6b10104736f6d65cf75277cb0ca9a5bafce0e35c2f42e5f371317f2e05dd7ab7c2d1acd595692e8f82ac92fccaff7c18a77822734f7c200668e1cb198460b54211abc129a1b542c0107426974636f696e0b53637269707442797465730501a4423c76c2f6e30f76ec95d8e84eaf5dd4d61ae04c7dd66f3ff7bb3efec301fefd5e5e2b936f3d2e7a4cc4c25d577db7483e2dc4b92e962a18cb7833e676845d0107426974636f696e04566f75740501e27fe166fdfab25710d8a6c6a747c8981a74db00977347ef564945c189592531ff6a9c7aa0a56f822c45e7359df8e40e7f0e92071f741dc436c71806db1663bb010b524742436f6e74726163740c4d656469615265674e616d650501c95b268678cd0f7a3e9d9daae025816f4f42e66d469170688364bccec631259300015650fb29bac1c7616f976727b1e81234887ad96e7056f5a3cc99e4a8378b31480c00035247420300d0d007000000010004d0075650fb29bac1c7616f976727b1e81234887ad96e7056f5a3cc99e4a8378b3148000002df32c1b98c0512eff59d0e2be0076f336f5122d0cc6ffb98e69dcda1579f20b000055247423230060c6275726e6564537570706c7901827e39faac0b9c30a347c9acc0806857daf002600a077285bdc792974b45461a0001076372656174656401cad1bb9def7267a8f680452ce3634fe7814da5fa4be92ca71c5edf12e6a1e43001000c697373756564537570706c7901827e39faac0b9c30a347c9acc0806857daf002600a077285bdc792974b45461a00010e7265706c61636564537570706c7901827e39faac0b9c30a347c9acc0806857daf002600a077285bdc792974b45461a0001047370656301711bf75b4c90f8e62e1ed39f88f4ac6b16fa5fdf34dcbea3b37fbc9e049f5fa80100057465726d7301b0bfb6fe0093af6b3230e5fd0d3d69aaf14bf098df07728d250bae37798610700100050a61737365744f776e657202000001096275726e45706f636801010000096275726e52696768740101000112696e666c6174696f6e416c6c6f77616e6365020100010b75706461746552696768740101000000010718363521c0c2e31915c8304a933e8f9c3e69d11ff99aaaa1499c61e98315b704076372656174656400010001000c697373756564537570706c79000100010004737065630001000100057465726d730001000100040a61737365744f776e6572000000ffff096275726e45706f6368000000010012696e666c6174696f6e416c6c6f77616e6365000000ffff0b75706461746552696768740000000100000301030406044275726e0101f4bdcb47aa7db1caab5656f482e6788f22cf4534f93d506cdb350e13b9d0d9eb010c6275726e6564537570706c79000100010001047573656401096275726e526967687401000100010666757475726501096275726e52696768740000010000030103050005497373756501010718363521c0c2e31915c8304a933e8f9c3e69d11ff99aaaa1499c61e98315b7010c697373756564537570706c7900010001000104757365640112696e666c6174696f6e416c6c6f77616e63650100ffff020b62656e6566696369617279010a61737365744f776e65720000ffff066675747572650112696e666c6174696f6e416c6c6f77616e63650000ffff000401030406010b62656e6566696369617279094f70656e45706f636801000001047573656401096275726e45706f63680100010002096275726e52696768740001000100046e65787401096275726e45706f636800000100000001096275726e52696768740652656e616d65010001036e657701047370656301000100010475736564010b7570646174655269676874010001000106667574757265010b75706461746552696768740000010000000106667574757265075265706c6163650101f4bdcb47aa7db1caab5656f482e6788f22cf4534f93d506cdb350e13b9d0d9eb010e7265706c61636564537570706c79000100010001047573656401096275726e526967687401000100020b62656e6566696369617279010a61737365744f776e65720000ffff0666757475726501096275726e526967687400000100000401020305010b62656e6566696369617279085472616e73666572000000010870726576696f7573010a61737365744f776e65720100ffff010b62656e6566696369617279010a61737365744f776e65720100ffff000102010a61737365744f776e65720031e4e2b06ffac24c5455a677c387081de1697ebb91ba71ef38825fc9301bc80301085472616e7366657200a043ff5bf8d27af550c4464a1a8936e3f240ee80f4879b576c8355b2cb851d3bdf32c1b98c0512eff59d0e2be0076f336f5122d0cc6ffb98e69dcda1579f20b00303000763726561746564d0070473706563d107057465726d7301d0070a61737365744f776e65720001d007085472616e7366657200f8452c08757306002f05704e82005996387bef3a4fc7be960116e9629f79216700055247423230060c6275726e6564537570706c7901827e39faac0b9c30a347c9acc0806857daf002600a077285bdc792974b45461a0001076372656174656401cad1bb9def7267a8f680452ce3634fe7814da5fa4be92ca71c5edf12e6a1e43001000c697373756564537570706c7901827e39faac0b9c30a347c9acc0806857daf002600a077285bdc792974b45461a00010e7265706c61636564537570706c7901827e39faac0b9c30a347c9acc0806857daf002600a077285bdc792974b45461a0001047370656301711bf75b4c90f8e62e1ed39f88f4ac6b16fa5fdf34dcbea3b37fbc9e049f5fa80100057465726d7301b0bfb6fe0093af6b3230e5fd0d3d69aaf14bf098df07728d250bae37798610700100050a61737365744f776e657202000001096275726e45706f636801010000096275726e52696768740101000112696e666c6174696f6e416c6c6f77616e6365020100010b75706461746552696768740101000000010718363521c0c2e31915c8304a933e8f9c3e69d11ff99aaaa1499c61e98315b704076372656174656400010001000c697373756564537570706c79000100010004737065630001000100057465726d730001000100040a61737365744f776e6572000000ffff096275726e45706f6368000000010012696e666c6174696f6e416c6c6f77616e6365000000ffff0b75706461746552696768740000000100000301030406044275726e0101f4bdcb47aa7db1caab5656f482e6788f22cf4534f93d506cdb350e13b9d0d9eb010c6275726e6564537570706c79000100010001047573656401096275726e526967687401000100010666757475726501096275726e52696768740000010000030103050005497373756501010718363521c0c2e31915c8304a933e8f9c3e69d11ff99aaaa1499c61e98315b7010c697373756564537570706c7900010001000104757365640112696e666c6174696f6e416c6c6f77616e63650100ffff020b62656e6566696369617279010a61737365744f776e65720000ffff066675747572650112696e666c6174696f6e416c6c6f77616e63650000ffff000401030406010b62656e6566696369617279094f70656e45706f636801000001047573656401096275726e45706f63680100010002096275726e52696768740001000100046e65787401096275726e45706f636800000100000001096275726e52696768740652656e616d65010001036e657701047370656301000100010475736564010b7570646174655269676874010001000106667574757265010b75706461746552696768740000010000000106667574757265075265706c6163650101f4bdcb47aa7db1caab5656f482e6788f22cf4534f93d506cdb350e13b9d0d9eb010e7265706c61636564537570706c79000100010001047573656401096275726e526967687401000100020b62656e6566696369617279010a61737365744f776e65720000ffff0666757475726501096275726e526967687400000100000401020305010b62656e6566696369617279085472616e73666572000000010870726576696f7573010a61737365744f776e65720100ffff010b62656e6566696369617279010a61737365744f776e65720100ffff000102010b62656e65666963696172790031e4e2b06ffac24c5455a677c387081de1697ebb91ba71ef38825fc9301bc80301085472616e7366657200a043ff5bf8d27af550c4464a1a8936e3f240ee80f4879b576c8355b2cb851d3bf8452c08757306002f05704e82005996387bef3a4fc7be960116e9629f7921670303000763726561746564d0070473706563d107057465726d7301d0070a61737365744f776e65720001d007085472616e7366657200000000a043ff5bf8d27af550c4464a1a8936e3f240ee80f4879b576c8355b2cb851d3b8000000303000100040000000000d00701000600014401440002d10701000200000001d007010100030173c939e215ba9d6c1d0c618db8f08368a6eacbdc0cbd70c10adce5ffe47c3e0900000000badef09b321516b1080500000000000000cce5c17f7d2b39af6f99bc1c1d7dbe115f617b4f963a514d272add6bc89c81260000000000000000000000000000".to_string(),
    };

    let req = serde_wasm_bindgen::to_value(&contract_import).expect("oh no!");
    let resp: JsValue = resolve(import_contract(sk.clone(), req)).await;
    let resp: ContractResponse = json_parse(&resp);

    // TODO: This not working =(
    // let resp: JsValue = resolve(list_contracts(sk)).await;
    // let resp: ContractsResponse = json_parse(&resp);

    // assert_eq!(1, resp.contracts.len());
}

#[wasm_bindgen_test]
async fn asset_transfer() {
    set_panic_hook();

    let mnemonic = env!("TEST_WALLET_SEED", "TEST_WALLET_SEED variable not set");
    let hash = hash_password(ENCRYPTION_PASSWORD.to_owned());

    // Import wallet
    let mnemonic_data_str = resolve(save_mnemonic_seed(
        mnemonic.to_owned(),
        hash.clone(),
        SEED_PASSWORD.to_owned(),
    ))
    .await;

    let mnemonic_data: MnemonicSeedData = json_parse(&mnemonic_data_str);

    // Get vault properties
    let wallet_data_str: JsValue = resolve(get_encrypted_wallet(
        hash,
        mnemonic_data.encrypted_descriptors,
    ))
    .await;
    let wallet_data: EncryptedWalletData = json_parse(&wallet_data_str);

    info!("Get Wallets");
    let assets_wallet = resolve(get_wallet_data(
        wallet_data.public.rgb_assets_descriptor_xpub.clone(),
        None,
    ))
    .await;
    let assets_wallet: WalletData = json_parse(&assets_wallet);
    let udas_wallet = resolve(get_wallet_data(
        wallet_data.public.rgb_udas_descriptor_xpub.clone(),
        None,
    ))
    .await;
    let udas_wallet: WalletData = json_parse(&udas_wallet);

    info!("Check Asset Vault");
    let vault_details = resolve(get_assets_vault(
        wallet_data.public.rgb_assets_descriptor_xpub.clone(),
        wallet_data.public.rgb_udas_descriptor_xpub,
    ))
    .await;
    let vault_details: FundVaultDetails = json_parse(&vault_details);
}
